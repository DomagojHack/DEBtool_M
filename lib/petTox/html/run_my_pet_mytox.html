
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>run_my_pet_mytox</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-06-06"><meta name="DC.source" content="run_my_pet_mytox.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1><a href="../run_my_pet_mytox.m"><b>run_my_pet_mytox</b></a></h1><pre class="codeinput">clear <span class="string">all</span>; close <span class="string">all</span>;
<span class="comment">%clc</span>
<span class="keyword">global</span> pets toxs

<span class="comment">% species names</span>
pets = {<span class="string">'my_pet'</span>};
toxs = {<span class="string">'mytox'</span>};
<span class="comment">% check_my_pet(pets); % check pet-files for required fields</span>

<span class="comment">% See estim_options for more options</span>
estim_options(<span class="string">'default'</span>); <span class="comment">% runs estimation, uses nmregr method and filter</span>
                          <span class="comment">% prints results, does not write file, does not produce html</span>
<span class="comment">% 'method':           'nm' - use Nelder-Mead method (default); 'no' - do not estimate;</span>
<span class="comment">% 'pars_init_method': 0 - get initial estimates from automatized computation (default)</span>
<span class="comment">%                     1 - read initial estimates from .mat file</span>
<span class="comment">%                     2 - read initial estimates from pars_init file</span>
<span class="comment">% 'results_output':   0 - prints results to screen; (default)</span>
<span class="comment">%                     1 - prints results to screen, saves to .mat file</span>
<span class="comment">%                     2 - saves data to .mat file and graphs to .png files</span>
<span class="comment">%                     (prints results to screen using a customized results file when there is one)</span>
<span class="comment">% 'nontox_pars_init_method': 0 - reads parameters from .mat of species (default)</span>
<span class="comment">%                            1 - reads parameters from pars_init of species</span>
<span class="comment">% 'nontox_par_estimation':   0 - fixes (does not estimate) all nontox parameters (default)</span>
<span class="comment">%                            1 - uses fix/free information from pars_init of species</span>

estim_options(<span class="string">'max_step_number'</span>,5e3); <span class="comment">% set options for parameter estimation</span>
estim_options(<span class="string">'max_fun_evals'</span>,5e3);  <span class="comment">% set options for parameter estimation</span>
<span class="comment">%estim_options('report',0);  % save time during the estimation</span>

estim_options(<span class="string">'pars_init_method'</span>, 2);
estim_options(<span class="string">'results_output'</span>, 0);
estim_options(<span class="string">'method'</span>, <span class="string">'no'</span>);

estim_pars; <span class="comment">% run estimation</span>
</pre><pre class="codeoutput">my_pet 
MRE =    0.603 


data and predictions (relative error) 
see figure (0.384) tN0, time since birth vs. cum. nb. eggs
see figure (0.3906) tN1, time since birth vs. cum. nb. eggs
see figure (0.5253) tN2, time since birth vs. cum. nb. eggs
see figure (0.7344) tN3, time since birth vs. cum. nb. eggs
see figure (1.05) tN4, time since birth vs. cum. nb. eggs
see figure (0.5334) tN5, time since birth vs. cum. nb. eggs

Parameters 
z, - 0.1325 0 
F_m, l/d.cm^2 6.5 0 
kap_X, - 0.9 0 
kap_P, - 0.05 0 
v, cm/d 0.1584 0 
kap, - 0.61 0 
kap_R, - 0.95 0 
p_M, J/d.cm^3 1453 0 
p_T, J/d.cm^2   0 0 
k_J, 1/d 0.002 0 
E_G, J/cm^3 4400 0 
E_Hb, J 0.01379 0 
E_Hp, J 0.3211 0 
h_a, 1/d^2 0.0003105 0 
s_G, - -0.3 0 
del_M, - 0.264 0 
T_A, K 6400 0 
T_ref, K 293.1 0 
f, -   1 0 
k_e, 1/d 0.1498 1 
c0, mMol/l 0.001 1 
cA, mMol/l 0.3991 1 
f_tN, - 0.9 1 

</pre><img vspace="5" hspace="5" src="run_my_pet_mytox_01.png" style="width:560px;height:420px;" alt=""> <img vspace="5" hspace="5" src="run_my_pet_mytox_02.png" style="width:560px;height:420px;" alt=""> <img vspace="5" hspace="5" src="run_my_pet_mytox_03.png" style="width:560px;height:420px;" alt=""> <img vspace="5" hspace="5" src="run_my_pet_mytox_04.png" style="width:560px;height:420px;" alt=""> <img vspace="5" hspace="5" src="run_my_pet_mytox_05.png" style="width:560px;height:420px;" alt=""> <img vspace="5" hspace="5" src="run_my_pet_mytox_06.png" style="width:560px;height:420px;" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% <../run_my_pet_mytox.m *run_my_pet_mytox*>

clear all; close all;
%clc
global pets toxs

% species names
pets = {'my_pet'};
toxs = {'mytox'};
% check_my_pet(pets); % check pet-files for required fields

% See estim_options for more options
estim_options('default'); % runs estimation, uses nmregr method and filter
                          % prints results, does not write file, does not produce html
% 'method':           'nm' - use Nelder-Mead method (default); 'no' - do not estimate;
% 'pars_init_method': 0 - get initial estimates from automatized computation (default)
%                     1 - read initial estimates from .mat file 
%                     2 - read initial estimates from pars_init file 
% 'results_output':   0 - prints results to screen; (default)
%                     1 - prints results to screen, saves to .mat file
%                     2 - saves data to .mat file and graphs to .png files
%                     (prints results to screen using a customized results file when there is one)
% 'nontox_pars_init_method': 0 - reads parameters from .mat of species (default)
%                            1 - reads parameters from pars_init of species 
% 'nontox_par_estimation':   0 - fixes (does not estimate) all nontox parameters (default)
%                            1 - uses fix/free information from pars_init of species 

estim_options('max_step_number',5e3); % set options for parameter estimation
estim_options('max_fun_evals',5e3);  % set options for parameter estimation
%estim_options('report',0);  % save time during the estimation 

estim_options('pars_init_method', 2);
estim_options('results_output', 0);
estim_options('method', 'no');

estim_pars; % run estimation
##### SOURCE END #####
--></body></html>